!function(t){"use strict";function e(t,e){for(var n=[],s=0;s<e.length;s++){var l=e[s];if(/^\s+/.test(l)){for(var a=[];s<e.length;s++){if(!/^\s+/.test(e[s])){s--;break}a.push(e[s].replace(/^\s+/,""))}n[n.length-1].children=o(a)}else n.push({tag:"li",md:e[s],children:[],html:r("ul"==t?e[s].replace(/^[\.\*\-]\s*/,""):e[s].replace(/^\d\.\s*/,""))})}return n}function r(t){return t=i(t),t=n(t),t=h(t),t=s(t),t=l(t),t=a(t)}function n(t){return t.replace(p.img,'<img alt="$1" src="$2">')}function s(t){return t.replace(p.a,function(t,e,n){return'<a href="'+n+'" target="_blank">'+r(e.replace(/\\([\(\)\[\])])/g,"$1"))+"</a>"})}function l(t){return t.replace(p.b,"<b>$1</b>")}function a(t){return t.replace(p.i,"<i>$1</i>")}function h(t){return t.replace(p.inlineCode,"<code>$1</code>")}function i(t){return t.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")}function c(t){for(var e=[],n=0;n<t.length;n++){var s=t[n];if(/^\s+/.test(s)){for(var l=[];n<t.length;n++){if(!/^\s+/.test(t[n])){n--;break}l.push(t[n].replace(/^\s+/,""))}e[e.length-1].children=o(l)}else e.push({tag:"p",md:s,children:[],html:r(s.replace(/^(!)?>/,""))})}return e}function u(t){function e(t){if(t<l.length&&"left"!==l[t])return{"text-align":l[t]}}for(var n=/[^|]+/g,s=t[1].match(n)||[],l=[],a=0,h=s.length;a<h;a++)/^\s*-+:\s*$/.test(s[a])?l.push("right"):/^\s*:-+:\s*$/.test(s[a])?l.push("center"):l.push("left");for(var i={tag:"tr",children:[]},c=t[0].match(n)||[],u=c.length,o=0;o<u;o++)i.children.push({tag:"th",style:e(o),md:c[o],html:r(c[o].trim())});for(var f=[],g=2,p=t.length;g<p;g++){for(var d={tag:"tr",children:[]},m=u,v=t[g].match(n)||[];m--;){var b=v[m];d.children.unshift({tag:"td",style:e(m),md:b,html:b?r(b.trim()):""})}f.push(d)}return[i].concat(f)}function o(t){for(var n=[],s=t.length,l="",a=0;a<s;a++){var h=t[a];if(p.title.test(h)){var o=/^#{1,6}/,f=h.match(o);n.push({tag:"h"+f[0].length,md:h,html:r(h.replace(o,"").slice(1))})}else if(p.hr.test(h))n.push({tag:"hr",md:h});else if((l=!!p.ul.test(h)&&"ul")||(l=!!p.ol.test(h)&&"ol")){for(g=[];a<s;a++){b=t[a];if(!p[l].test(b)&&!/^\s+.+/.test(b)){a--;break}g.push(b)}n.push({tag:l,children:e(l,g),md:g.join("\n")})}else if(p.table.test(h)&&t[a+1]&&p.align.test(t[a+1])){g=[h,t[a+1]];for(a+=2;a<s;a++){b=t[a];if(!p.table.test(b)){a--;break}g.push(b)}n.push({tag:"table",children:u(g),md:g.join("\n")})}else if(p.blockquote.test(h)){var g=[h],d=0==h.indexOf("!")?"warning":"";for(a++;a<s;a++){b=t[a];if(!p.blockquote.test(b)&&!/^\s+.+/.test(b)){a--;break}g.push(b)}n.push({tag:"blockquote",class:d,children:c(g),md:g.join("\n")})}else if(p.code.test(h)){var m=h.match(/[^`\s]+/);m=m?m[0]:"";var v="";for(a++;a<s;a++){var b=i(t[a]);if(p.code.test(b))break;v+=b,/^\n/.test(b)||(v+="\n")}n.push({tag:"pre",children:[{tag:"code",html:v}],attr:{"data-lang":m},class:m,md:h+"\n"+v+"```"})}else/^\n+/.test(h)||n.push({tag:"p",md:h,html:r(h)})}return n}function f(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];if("text"==n.tag)e.push(n.html),n.children&&e.push(f(n.children));else{if(e.push("<"+n.tag),n.class&&e.push(' class="'+n.class+'" '),n.style){e.push(' style="');for(var s in n.style)e.push(s+":"+n.style[s]+";");e.push('" ')}if(n.attr)for(var l in n.attr)e.push(" "+l+'="'+n.attr[l]+'" ');e.push(">"),n.html&&e.push(n.html),n.children&&e.push(f(n.children)),e.push("</"+n.tag+">")}}return e.join("")}function g(t){return o(t.match(/.+|^\n/gm)||[])}var p={title:/^#{1,6}\s+.+$/,ul:/^[\.\-\*]\s+.+$/,ol:/^\d+\.\s?.+$/,blockquote:/^!?>.+?$/,code:/^\`{3}.*$/,table:/^(\|[^|]+)+\|\s*$/,align:/^(\|\s*:?-+:?\s*)+\|\s*$/,hr:/^(\*|\_|\-){3,}$/,img:/\!\[(.*?)\]\((.*?)\)/g,a:/\[((?:[^\(\)\[\]]|\\\[|\\\]|\\\(|\\\))+)\]\((.+?)\)/g,b:/\*\*(.+?)\*\*/g,i:/\*(.+?)\*/g,inlineCode:/\`(.+?)\`/g};t.mdToTree=g,t.mdToHtml=function(t){return f(g(t))},t.treeToHtml=f}(this.md=this.md||{});
