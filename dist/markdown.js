!function(t){"use strict";function e(t,e){for(var s=[],n=0;n<e.length;n++){var a=e[n];if(/^\s+/.test(a)){for(var l=[];n<e.length;n++){if(!/^\s+/.test(e[n])){n--;break}l.push(e[n].replace(/^\s+/,""))}s[s.length-1].children=o(l)}else s.push({tag:"li",md:e[n],children:[],text:r("ul"==t?e[n].replace(/^[\.\*\-]\s*/,""):e[n].replace(/^\d\.\s*/,""))})}return s}function r(t){return t=h(t),t=s(t),t=i(t),t=n(t),t=a(t),t=l(t)}function s(t){return t.replace(p.img,'<img class="mdeditor-img" alt="$1" src="$2">')}function n(t){return t.replace(p.a,function(t,e,r){return'<a href="'+r+'" target="_blank">'+a(e.replace(/\\([\(\)\[\])])/g,"$1"))+"</a>"})}function a(t){return t.replace(p.b,"<b>$1</b>")}function l(t){return t.replace(p.i,"<i>$1</i>")}function i(t){return t.replace(p.inlineCode,'<span class="mdeditor-inline-code">$1</span>')}function h(t){return t.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")}function u(t){for(var e=[],s=0;s<t.length;s++){var n=t[s];if(/^\s+/.test(n)){for(var a=[];s<t.length;s++){if(!/^\s+/.test(t[s])){s--;break}a.push(t[s].replace(/^\s+/,""))}e[e.length-1].children=o(a)}else e.push({tag:"text",md:n,children:[],text:r(n.replace(/^(!)?>/,""))})}return e}function c(t){function e(t){if(t<a.length&&"left"!==a[t])return{"text-align":a[t]}}for(var s=/[^|]+/g,n=t[1].match(s)||[],a=[],l=0,i=n.length;l<i;l++)/^\s*-+:\s*$/.test(n[l])?a.push("right"):/^\s*:-+:\s*$/.test(n[l])?a.push("center"):a.push("left");for(var h={tag:"tr",children:[]},u=t[0].match(s)||[],c=u.length,o=0;o<c;o++)h.children.push({tag:"th",style:e(o),md:u[o],text:r(u[o].trim())});for(var f=[],g=2,p=t.length;g<p;g++){for(var d={tag:"tr",children:[]},m=c,v=t[g].match(s)||[];m--;){var b=v[m];d.children.unshift({tag:"td",style:e(m),md:b,text:b?r(b.trim()):""})}f.push(d)}return[h].concat(f)}function o(t){for(var s=[],n=t.length,a="",l=0;l<n;l++){var i=t[l];if(p.title.test(i)){var h=/^#{1,6}/,o=i.match(h);s.push({tag:"h"+o[0].length,md:i,text:r(i.replace(h,""))})}else if(p.hr.test(i))s.push({tag:"hr",md:i});else if((a=!!p.ul.test(i)&&"ul")||(a=!!p.ol.test(i)&&"ol")){for(f=[];l<n;l++){v=t[l];if(!p[a].test(v)&&!/^\s+.+/.test(v)){l--;break}f.push(v)}s.push({tag:a,children:e(a,f),md:f})}else if(p.table.test(i)&&t[l+1]&&p.align.test(t[l+1])){f=[i,t[l+1]];for(l+=2;l<n;l++){v=t[l];if(!p.table.test(v)){l--;break}f.push(v)}s.push({tag:"table",children:c(f),md:f})}else if(p.blockquote.test(i)){var f=[i],g=0==i.indexOf("!")?"warning":"";for(l++;l<n;l++){v=t[l];if(!p.blockquote.test(v)&&!/^\s+.+/.test(v)){l--;break}f.push(v)}s.push({tag:"blockquote",class:g,children:u(f),md:f})}else if(p.code.test(i)){var f=[i],d=i.match(/[^`\s]+/);d=d?d[0]:"";var m="";for(l++;l<n;l++){var v=t[l];if(p.code.test(v))break;f.push(v),m+=v,/^\n/.test(v)||(m+="\n")}f.push("```"),s.push({tag:"pre",children:[{tag:"code",text:m}],attr:{"data-lang":d},class:d,md:f})}else/^\n+/.test(i)||s.push({tag:"p",md:i,text:r(i)})}return s}function f(t){for(var e=[],r=0;r<t.length;r++){var s=t[r];if("text"==s.tag)e.push(s.text),s.children&&e.push(f(s.children));else{if(e.push("<"+s.tag),s.class&&e.push(' class="'+s.class+'" '),s.style){e.push(' style="');for(var n in s.style)e.push(n+":"+s.style[n]+";");e.push('" ')}if(s.attr)for(var a in s.attr)e.push(" "+a+'="'+s.attr[a]+'" ');e.push(">"),s.text&&e.push(s.text),s.children&&e.push(f(s.children)),e.push("</"+s.tag+">")}}return e.join("")}function g(t){return o(t.match(/.+|^\n/gm)||[])}var p={title:/^(#{1,6}).+$/,ul:/^[\.\-\*]\s+.+$/,ol:/^\d+\.\s?.+$/,blockquote:/^!?>.+?$/,code:/^\`{3}.*$/,table:/^(\|[^|]+)+\|\s*$/,align:/^(\|\s*:?-+:?\s*)+\|\s*$/,hr:/^(\*|\_|\-){3,}$/,img:/\!\[(.*?)\]\((.*?)\)/g,a:/\[((?:[^\(\)\[\]]|\\\[|\\\]|\\\(|\\\))+)\]\((.+?)\)/g,b:/\*\*(.+?)\*\*/g,i:/\*(.+?)\*/g,inlineCode:/\`(.+?)\`/g};t.mdToTree=g,t.mdToHtml=function(t){return f(g(t))}}(this.md=this.md||{});
